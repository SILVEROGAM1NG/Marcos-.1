/**
</> Original base BochilGaming 
</> Recode simple by @NeKosmic
**/

import db from"../lib/database.js";const items=["nkoins","elixir","basura","madera","roca","cuerda","miMascot","esmeralda","diamante","oro","hierro","ordinario","singular","mitico","legendario","mascota"];let confirmation={};async function handler(e,{conn:n,args:r,command:t}){if(confirmation[e.sender])return e.reply("Ya estas realizando una transferencia!");const a=db.data.users[e.sender],i=items.filter((e=>e in a&&"number"==typeof a[e])),o=`Usar formato ${Prefijo}${t} [tipo] [cantidad] [n√∫mero]\nejemplo de uso:\n\n${Prefijo}${t} nkoins 9999 @51995386439\n\nüìç Art√≠culos transferibles\n${i.map((e=>`${rpg.emoticon(e)}${e}`.trim())).join("\n")}\n`.trim(),s=(r[0]||"").toLowerCase();if(!i.includes(s))return e.reply(o);const l=1*Math.min(Number.MAX_SAFE_INTEGER,Math.max(1,isNumber(r[1])?parseInt(r[1]):1)),d=e.mentionedJid&&e.mentionedJid[0]?e.mentionedJid[0]:r[2]?r[2].replace(/[@ .+-]/g,"")+"@s.whatsapp.net":"";if(!d)return e.reply("Etiqueta a un usuario √≥ escribe el n√∫mero!!");if(!(d in db.data.users))return e.reply(`Usuario *${d}* no se encuentra en la base de datos -.-`);if(1*a[s]<l)return e.reply(`Su *${rpg.emoticon(s)}${s}${special(s)}* es menos que *${l-a[s]}*`);const m=`\n¬øEst√° seguro de que desea transferir *${l}* ${rpg.emoticon(s)}${s}${special(s)} a *@${(d||"").replace(/@s\.whatsapp\.net/g,"")}*\n\nTienes 60 segundos\n`.trim(),c=NombreDelBot;n.sendButton(e.chat,m,c,null,[["sip"],["nop"]],e,{mentions:[d]}),confirmation[e.sender]={sender:e.sender,to:d,message:e,type:s,count:l,timeout:setTimeout((()=>(e.reply("Se acab√≥ el tiempo..."),delete confirmation[e.sender])),6e4)}}handler.before=async e=>{if(e.isBaileys)return;if(!(e.sender in confirmation))return;if(!e.text)return;let{timeout:n,sender:r,message:t,to:a,type:i,count:o}=confirmation[e.sender];if(e.id===t.id)return;let s=db.data.users[r],l=db.data.users[a];if(/nop/g.test(e.text.toLowerCase()))return clearTimeout(n),delete confirmation[r],e.reply("Rechazado");if(/sip/g.test(e.text.toLowerCase())){let t=1*s[i],d=1*l[i];s[i]-=1*o,l[i]+=1*o,t>1*s[i]&&d<1*l[i]?e.reply(`Transferencia exitosa *${o}* ${rpg.emoticon(i)}${i}${special(i)} a *@${(a||"").replace(/@s\.whatsapp\.net/g,"")}*`,null,{mentions:[a]}):(s[i]=t,l[i]=d,e.reply(`Error al transferir *${o}* ${rpg.emoticon(i)}${i}${special(i)} a *@${(a||"").replace(/@s\.whatsapp\.net/g,"")}*`,null,{mentions:[a]})),clearTimeout(n),delete confirmation[r]}},handler.help=["transferir"],handler.tags=["games"],handler.command=/^transferir$/i,handler.disabled=!1;export default handler;function special(e){let n=e.toLowerCase();return["ordinario","singular","mitico","legendario","mascota"].includes(n)?" Caja":""}function isNumber(e){return!isNaN(e)}

/**
[_>] https://github.com/NeKosmic/
[_>] https://gitlab.com/NeKosmic/
**/